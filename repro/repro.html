<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Repro</title>
    <link rel="stylesheet" href="repro.css">
    <script src="jsoneditor.js"></script>
    <script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script type="text/javascript" src="eventBridgeLoader.js"></script>
</head>
<body>
    <h3>User</h3>
        <p id="usersection">
        <!-- Some text -->
        </p>

    <h3>Avatar</h3>
        <p id ="avatarsection">
        <!-- Some text -->
        </p/>

    <h3>Location</h3>
    <p id ="locationsection">
        <!-- Some text -->
    </p>

    <h3>Avatar Position</h3>
    <p id ="positionsection">
        <!-- Some text -->
    </p>

    <h3>Scene</h3>
    <p id ="scenesection">
        <!-- Some text -->
    </p>

    <h3>Entities</h3>
    <p id ="entitiessection">
        <!-- Some text -->
    </p>

    <h3>Images</h3>
    <p id ="imagessection">
        <!-- Some images -->
        <img id="screenshot1" style="width:400px;height:400px;">
        <img id="screenshot2" style="width:400px;height:400px;">

    </p>


    <script>
        var myBridge;
        window.onload = function() {
            console.log('window loaded, opening event bridge')
            openEventBridge(function(eventBridge) {
                myBridge = eventBridge;
                myBridge.scriptEventReceived.connect(function(message) {
                console.log("HTML side received message: " + message);
                 var usersection = document.getElementById("usersection");
                    usersection.innerHTML = message;


                });
            });
        }


        var reproinfo = {
            user: "ozan",
            avatar: "MyAvatar.skeletonModelURL",
            place: "location.href",
            position: "MyAvatar.position or location.href",
            scene: "JSON.stringify(Scene)",
            entities: "entity1, entity2"
        };

        //Test
        var text = '{"employees":[{"firstName":"John","lastName":"Doe" },{"firstName":"Anna","lastName":"Smith" }, {"firstName":"Peter","lastName":"Jones" }]}';

        obj = JSON.parse(text);
        document.getElementById("avatarsection").innerHTML = obj.employees[1].firstName + " " + obj.employees[1].lastName;
        //End test

        var locationsection = document.getElementById("locationsection");
        locationsection.innerHTML = reproinfo.place;

        var posText ='{"x":7229.26318359375,"y":4950.5380859375,"z":5042.74951171875}';
        var posObj = JSON.parse(posText);
        var positionsection = document.getElementById("positionsection");
        positionsection.innerHTML = "x = " + posObj.x + " <br> y = " + posObj.y + " <br> z =  " + posObj.z;

        var scenesection = document.getElementById("scenesection");
        scenesection.innerHTML = reproinfo.scene;

        var modUrlText = '{"modelURL": "https://s3.amazonaws.com/hifi-public/marketplace/hificontent/ozan/PalmTree.fbx"}';
        var modPosText = '{"x":7229.26318359375,"y":4950.5380859375,"z":5042.74951171875}';
        var modURLObj = JSON.parse(modUrlText);
        var modPosObj = JSON.parse(modPosText);

        var entitiessection = document.getElementById("entitiessection");
        entitiessection.innerHTML = modURLObj.modelURL + "<br> x = " + modPosObj.x;

        document.getElementById("screenshot1").src = "images/huffmeme.jpg";
        document.getElementById("screenshot2").src = "images/huffmeme.jpg";

    </script>
    </body>
</html>